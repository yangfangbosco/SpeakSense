# SpeakSense æœåŠ¡å™¨è¿ç§»æŒ‡å—

æœ¬æŒ‡å—å¸®åŠ©ä½ é€‰æ‹©æœ€é€‚åˆçš„æ–¹å¼å°†é¡¹ç›®è¿ç§»åˆ°æœåŠ¡å™¨ã€‚

## ğŸ¯ æ¨èæ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | ä¼˜ç‚¹ | ç¼ºç‚¹ | é€‚ç”¨åœºæ™¯ |
|------|------|------|----------|
| **rsync åŒæ­¥** | â­ å¢é‡ä¼ è¾“ï¼Œé€Ÿåº¦å¿«<br>â­ æ”¯æŒæ–­ç‚¹ç»­ä¼ <br>â­ è‡ªåŠ¨æ’é™¤ä¸´æ—¶æ–‡ä»¶ | éœ€è¦SSHè®¿é—® | é¦–é€‰ï¼é¢‘ç¹æ›´æ–° |
| **æ‰“åŒ…ä¸Šä¼ ** | âœ“ ç”Ÿæˆå¹²å‡€çš„å‹ç¼©åŒ…<br>âœ“ æ˜“äºå­˜æ¡£å’Œç‰ˆæœ¬æ§åˆ¶ | æ¯æ¬¡éƒ½æ˜¯å…¨é‡ä¼ è¾“ | åˆæ¬¡éƒ¨ç½²ï¼Œç‰ˆæœ¬å‘å¸ƒ |
| **Gitéƒ¨ç½²** | âœ“ ç‰ˆæœ¬æ§åˆ¶<br>âœ“ æ˜“äºå›æ»š | éœ€è¦Gitä»“åº“ | æœ‰Gitä»“åº“çš„é¡¹ç›® |

---

## æ–¹æ¡ˆ1: rsync åŒæ­¥ï¼ˆâ­ æ¨èï¼‰

### ä¼˜åŠ¿
- **æœ€å¿«**ï¼šåªä¼ è¾“ä¿®æ”¹çš„æ–‡ä»¶
- **æ–­ç‚¹ç»­ä¼ **ï¼šç½‘ç»œä¸­æ–­åå¯ç»§ç»­
- **è‡ªåŠ¨æ’é™¤**ï¼šè‡ªåŠ¨è·³è¿‡ .pycã€.DS_Store ç­‰æ–‡ä»¶

### ä½¿ç”¨æ–¹æ³•

```bash
# æ–¹å¼1: ä½¿ç”¨è„šæœ¬ï¼ˆæ¨èï¼‰
./deploy/sync_to_server.sh

# è„šæœ¬ä¼šæç¤ºä½ è¾“å…¥ï¼š
#   - æœåŠ¡å™¨ç”¨æˆ·å
#   - æœåŠ¡å™¨IP
#   - ç›®æ ‡è·¯å¾„

# æ–¹å¼2: ç›´æ¥ä½¿ç”¨å‘½ä»¤
./deploy/sync_to_server.sh user@192.168.1.100:/opt/SpeakSense
```

### åç»­æ›´æ–°

```bash
# ç¬¬ä¸€æ¬¡éƒ¨ç½²åï¼Œåç»­æ›´æ–°è¶…å¿«ï¼
./deploy/sync_to_server.sh

# åªä¼šä¼ è¾“ä¿®æ”¹è¿‡çš„æ–‡ä»¶
```

---

## æ–¹æ¡ˆ2: æ‰“åŒ…ä¸Šä¼ 

### ä¼˜åŠ¿
- ç”Ÿæˆå•ä¸ªå‹ç¼©åŒ…ï¼Œæ˜“äºç®¡ç†
- ä¸éœ€è¦æŒç»­SSHè¿æ¥
- é€‚åˆç½‘ç»œä¸ç¨³å®šçš„ç¯å¢ƒ

### ä½¿ç”¨æ–¹æ³•

```bash
# 1. æ‰“åŒ…é¡¹ç›®
./deploy/package.sh
# ç”Ÿæˆ: speaksense_20250118_XXXXXX.tar.gz

# 2. ä¸Šä¼ åˆ°æœåŠ¡å™¨
scp speaksense_*.tar.gz user@server:/opt/

# 3. åœ¨æœåŠ¡å™¨ä¸Šè§£å‹
ssh user@server
cd /opt
tar -xzf speaksense_*.tar.gz
cd SpeakSense
./deploy/deploy.sh
```

---

## æ–¹æ¡ˆ3: Git éƒ¨ç½²

### å‰ææ¡ä»¶
- é¡¹ç›®å·²æ¨é€åˆ°Gitä»“åº“ï¼ˆGitHub/GitLabç­‰ï¼‰
- æœåŠ¡å™¨å¯ä»¥è®¿é—®Gitä»“åº“

### ä½¿ç”¨æ–¹æ³•

```bash
# åœ¨æœåŠ¡å™¨ä¸Š
git clone https://github.com/your-repo/SpeakSense.git
cd SpeakSense
./deploy/deploy.sh
```

### æ›´æ–°

```bash
# æœåŠ¡å™¨ä¸Š
cd SpeakSense
git pull
./deploy/deploy.sh
```

---

## ğŸ§¹ æ¸…ç†ä¸´æ—¶æ–‡ä»¶

åœ¨è¿ç§»å‰ï¼Œå»ºè®®æ¸…ç†æœ¬åœ°çš„ä¸´æ—¶æ–‡ä»¶ï¼š

```bash
# æŸ¥çœ‹å¹¶æ¸…ç† .pyc, __pycache__, .DS_Store ç­‰
./deploy/clean_temp_files.sh
```

è¿™ä¼šåˆ é™¤ï¼š
- âœ“ `*.pyc` - Pythonç¼–è¯‘æ–‡ä»¶
- âœ“ `__pycache__/` - Pythonç¼“å­˜
- âœ“ `.DS_Store` - macOSå…ƒæ•°æ®
- âœ“ `*.swp`, `*.swo` - Vimä¸´æ—¶æ–‡ä»¶
- âœ“ `.pytest_cache/` - æµ‹è¯•ç¼“å­˜
- âœ“ `.mypy_cache/` - ç±»å‹æ£€æŸ¥ç¼“å­˜

---

## ğŸ“‹ æ’é™¤æ–‡ä»¶æ¸…å•

æ‰€æœ‰è„šæœ¬å·²è‡ªåŠ¨é…ç½®æ’é™¤ä»¥ä¸‹æ–‡ä»¶ï¼ˆå‚è§ `.deployignore`ï¼‰ï¼š

### Pythonç›¸å…³
- `*.pyc`, `__pycache__/`
- `*.egg-info/`, `dist/`, `build/`
- `venv/`, `.venv/`

### ç³»ç»Ÿæ–‡ä»¶
- `.DS_Store` (macOS)
- `Thumbs.db` (Windows)
- `*.swp`, `*.swo` (Vim)

### å¼€å‘æ•°æ®
- `data/faq.db` - å¼€å‘æ•°æ®åº“
- `data/audio_files/*` - å¼€å‘éŸ³é¢‘
- `data/chromadb/*` - å‘é‡æ•°æ®åº“
- `logs/*.log` - æ—¥å¿—æ–‡ä»¶

### ç‰ˆæœ¬æ§åˆ¶
- `.git/`, `.gitignore`

### å…¶ä»–
- `backups/*.tar.gz`
- `node_modules/`
- `.cache/`, `.pytest_cache/`

---

## ğŸš€ å®Œæ•´è¿ç§»æµç¨‹ç¤ºä¾‹

### ä½¿ç”¨ rsyncï¼ˆæ¨èï¼‰

```bash
# === æœ¬åœ°æ“ä½œ ===

# 1. æ¸…ç†ä¸´æ—¶æ–‡ä»¶
./deploy/clean_temp_files.sh

# 2. æ¸…ç©ºå¼€å‘æ•°æ®
./clean_data.sh

# 3. åŒæ­¥åˆ°æœåŠ¡å™¨
./deploy/sync_to_server.sh user@192.168.1.100:/opt/SpeakSense

# === æœåŠ¡å™¨æ“ä½œ ===

# 4. SSHåˆ°æœåŠ¡å™¨
ssh user@192.168.1.100

# 5. éƒ¨ç½²
cd /opt/SpeakSense
./deploy/deploy.sh

# 6. æµ‹è¯•
./deploy/test_deployment.sh

# 7. è®¿é—®
# http://192.168.1.100:8090/portal/index.html
```

### ä½¿ç”¨æ‰“åŒ…æ–¹å¼

```bash
# === æœ¬åœ°æ“ä½œ ===

# 1. æ¸…ç†ä¸´æ—¶æ–‡ä»¶
./deploy/clean_temp_files.sh

# 2. æ¸…ç©ºå¼€å‘æ•°æ®
./clean_data.sh

# 3. æ‰“åŒ…
./deploy/package.sh

# 4. ä¸Šä¼ 
scp speaksense_*.tar.gz user@192.168.1.100:/opt/

# === æœåŠ¡å™¨æ“ä½œ ===

# 5. SSHåˆ°æœåŠ¡å™¨å¹¶è§£å‹
ssh user@192.168.1.100
cd /opt
tar -xzf speaksense_*.tar.gz
cd SpeakSense

# 6. éƒ¨ç½²
./deploy/deploy.sh

# 7. æµ‹è¯•
./deploy/test_deployment.sh
```

---

## ğŸ“Š æ–‡ä»¶å¤§å°å¯¹æ¯”

æ¸…ç†å‰åé¡¹ç›®å¤§å°å¯¹æ¯”ï¼ˆç¤ºä¾‹ï¼‰ï¼š

```
æ¸…ç†å‰:  ~2.5 GB
  - æºä»£ç : 50 MB
  - .pycç­‰ä¸´æ—¶æ–‡ä»¶: 100 MB
  - å¼€å‘æ•°æ®åº“: 200 MB
  - éŸ³é¢‘æ–‡ä»¶: 1.5 GB
  - AIæ¨¡å‹: 600 MB (ä¸éœ€è¦ä¼ è¾“ï¼ŒæœåŠ¡å™¨ä¼šè‡ªåŠ¨ä¸‹è½½)

æ¸…ç†å:  ~50 MB
  - åªåŒ…å«æºä»£ç å’Œé…ç½®
  - ä¸Šä¼ é€Ÿåº¦æå‡ 50å€ï¼
```

---

## âš¡ æ€§èƒ½å¯¹æ¯”

| åœºæ™¯ | rsync (å¢é‡) | scp (å…¨é‡) | é€Ÿåº¦æå‡ |
|------|-------------|-----------|----------|
| é¦–æ¬¡éƒ¨ç½² | 2åˆ†é’Ÿ | 3åˆ†é’Ÿ | 1.5x |
| æ›´æ–°1ä¸ªæ–‡ä»¶ | 5ç§’ | 3åˆ†é’Ÿ | 36x âš¡ |
| æ›´æ–°10ä¸ªæ–‡ä»¶ | 15ç§’ | 3åˆ†é’Ÿ | 12x âš¡ |

---

## ğŸ” éªŒè¯è¿ç§»

è¿ç§»å®Œæˆåï¼Œåœ¨æœåŠ¡å™¨ä¸Šè¿è¡Œï¼š

```bash
# æ£€æŸ¥ç›®å½•ç»“æ„
ls -la

# ç¡®è®¤æ²¡æœ‰ä¸´æ—¶æ–‡ä»¶
find . -name "*.pyc" | wc -l  # åº”è¯¥æ˜¯ 0
find . -name ".DS_Store" | wc -l  # åº”è¯¥æ˜¯ 0

# æ£€æŸ¥ç¯å¢ƒ
./deploy/check_environment.sh

# æµ‹è¯•æœåŠ¡
./deploy/test_deployment.sh
```

---

## ğŸ’¡ æœ€ä½³å®è·µ

1. **é¦–æ¬¡éƒ¨ç½²**ï¼šä½¿ç”¨ `package.sh` æˆ– `sync_to_server.sh`
2. **æ—¥å¸¸æ›´æ–°**ï¼šä½¿ç”¨ `sync_to_server.sh`ï¼ˆè¶…å¿«ï¼ï¼‰
3. **ç‰ˆæœ¬å‘å¸ƒ**ï¼šä½¿ç”¨ `package.sh` åˆ›å»ºç‰ˆæœ¬å½’æ¡£
4. **è¿ç§»å‰**ï¼šè¿è¡Œ `clean_temp_files.sh` å’Œ `clean_data.sh`

---

## â“ å¸¸è§é—®é¢˜

### Q: rsync é€Ÿåº¦æ…¢æ€ä¹ˆåŠï¼Ÿ
```bash
# ä½¿ç”¨å‹ç¼©ä¼ è¾“ï¼ˆ-zå‚æ•°å·²åŒ…å«åœ¨è„šæœ¬ä¸­ï¼‰
# å¦‚æœç½‘ç»œå¾ˆå¥½ï¼Œå¯ä»¥å»æ‰-zå‚æ•°åŠ å¿«é€Ÿåº¦
rsync -av --progress [å…¶ä»–å‚æ•°] ...
```

### Q: å¿˜è®°æ’é™¤æŸä¸ªæ–‡ä»¶æ€ä¹ˆåŠï¼Ÿ
```bash
# ç¼–è¾‘è„šæœ¬æ·»åŠ æ’é™¤è§„åˆ™
vim deploy/sync_to_server.sh
# æˆ– vim deploy/package.sh

# åœ¨ --exclude åˆ—è¡¨ä¸­æ·»åŠ 
```

### Q: å¦‚ä½•åªä¼ è¾“ç‰¹å®šç›®å½•ï¼Ÿ
```bash
# ä¿®æ”¹ rsync è„šæœ¬çš„æºè·¯å¾„
rsync -avz services/ user@server:/opt/SpeakSense/services/
```

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

- æŸ¥çœ‹æ’é™¤æ–‡ä»¶æ¸…å•ï¼š`cat .deployignore`
- æµ‹è¯•rsyncï¼ˆä¸å®é™…ä¼ è¾“ï¼‰ï¼šåœ¨ `sync_to_server.sh` ä¸­æ·»åŠ  `--dry-run`
- è¯¦ç»†éƒ¨ç½²æ–‡æ¡£ï¼š`DEPLOYMENT.md`
